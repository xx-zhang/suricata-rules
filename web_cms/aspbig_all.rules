# Created by WatcherLAB on 2019-03-07.
# Copyright Â© 2019 WatcherLAB. All rights reserved.

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type 3Fexe Shell"; flow:established,from_client; content:".:: 3fexe Shell ::."; content:".:: Smart.Shell 1.0"; metadata:created_at 2019_03_07; sid:80000001; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type 3Fexe Shell"; flow:established,from_client; content:"action=download&file="; content:"o.GET.o"; content:"o.REN.o"; content:"o.DEL.o"; content:"o.VIEW.o"; content:"o.EDIT.o"; metadata:created_at 2019_03_07; sid:80000002; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPsh Shell"; flow:established,from_client; content:"<TITLE>ASPsh"; content:"loading..."; metadata:created_at 2019_03_07; sid:80000003; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPsh Shell"; flow:established,from_client; content:"gbLoaded"; content:"goTitle"; content:"goUploadFrom"; content:"goDownloadButton"; content:"gsCwd"; content:"giTimeout"; metadata:created_at 2019_03_07; sid:80000004; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPsh Shell"; flow:established,from_client; content:"getXML(asData)"; content:"body_onload()"; content:"body_onkeydown()"; content:"addHistory()"; content:"goHistory(iMove)"; content:"HTMLencode(sText)"; metadata:created_at 2019_03_07; sid:80000005; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPSpyder Shell"; flow:established,from_client; content:"ASPSpyder"; content:"Access"; content:"password"; metadata:created_at 2019_03_07; sid:80000006; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPSpyder Shell"; flow:established,from_client; content:"document.myform.txtpath.value"; content:"getDRVs=@&txtpath"; content:"qa=@&txtpath"; content:"upload=@&txtpath"; content:"Listed:"; content:"frmCopySelected"; metadata:created_at 2019_03_07; sid:80000007; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPSpyder Shell"; content:"POST"; http_method; flow:established,from_client; content:"document.myform.txtpath.value"; content:"getDRVs=@&txtpath"; content:"qa=@&txtpath"; content:"upload=@&txtpath"; content:"Listed:"; content:"frmCopySelected"; content:"code"; content:"submit"; content:"Access"; http_client_body; metadata:created_at 2019_03_07; sid:80000030; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPSpyder Shell"; content:"POST"; http_method; flow:established,from_client; content:"document.myform.txtpath.value"; content:"getDRVs=@&txtpath"; content:"qa=@&txtpath"; content:"upload=@&txtpath"; content:"Listed:"; content:"frmCopySelected"; content:"txtpath"; content:"cmd"; content:"View"; http_client_body; metadata:created_at 2019_03_07; sid:80000031; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASPSpyder Shell"; content:"POST"; http_method; flow:established,from_client; content:"Fname"; content:"cmd"; content:"Download"; http_client_body; metadata:created_at 2019_03_07; sid:80000032; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type cmdasp Shell"; flow:established,from_client; content:".CMD"; content:"size="; content:"method="; content:"value="; metadata:created_at 2019_03_07; sid:80000008; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type cmdasp Shell"; content:"POST"; http_method; flow:established,from_client; content:".CMD"; content:"size="; content:"method="; content:"value="; http_client_body; metadata:created_at 2019_03_07; sid:80000033; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; flow:established,from_client; content:"::: ELMALISEKER :::"; http_client_body; metadata:created_at 2019_03_07; sid:80000009; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; flow:established,from_client; content:"chkShowDriveInfo"; content:"lstDrive"; content:"chkShowFileInfo"; content:"cmdOption"; content:"txtShowPrefix"; http_client_body; metadata:created_at 2019_03_07; sid:80000010; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; flow:established,from_client; content:"winName.replace"; content:"urlLoc"; content:"Command(cmd, param)"; content:"frmFile.command.value"; content:"frmAddress.param.focus()"; content:"CheckName(str)"; http_client_body; metadata:created_at 2019_03_07; sid:80000011; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; content:"POST"; http_method; flow:established,from_client; content:"winName.replace"; content:"urlLoc"; content:"Command(cmd, param)"; content:"frmFile.command.value"; content:"frmAddress.param.focus()"; content:"CheckName(str)"; content:"FolderPath"; http_client_body; metadata:created_at 2019_03_07; sid:80000034; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; content:"POST"; http_method; flow:established,from_client; content:"winName.replace"; content:"urlLoc"; content:"Command(cmd, param)"; content:"frmFile.command.value"; content:"frmAddress.param.focus()"; content:"CheckName(str)"; content:"command"; content:"param"; content:"OpenFolder"; http_client_body; metadata:created_at 2019_03_07; sid:80000035; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; flow:established,from_client; content:"name=frmCMD"; content:"name=tmpdir"; content:"name=shell"; content:"name=cmd"; content:"name=echo"; content:"frmCMD.cmd.focus()"; http_client_body; metadata:created_at 2019_03_07; sid:80000012; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type elmaliseker backd00r Shell"; content:"POST"; http_method; flow:established,from_client; content:"name=frmCMD"; content:"name=tmpdir"; content:"name=shell"; content:"name=cmd"; content:"name=echo"; content:"frmCMD.cmd.focus()"; content:"tmpdir"; content:"shell"; content:"cmd"; http_client_body; metadata:created_at 2019_03_07; sid:80000036; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_LIST Shell"; flow:established,from_client; content:"ASP_KIT"; content:"list.asp"; content:"modified"; metadata:created_at 2019_03_07; sid:80000013; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_LIST Shell"; flow:established,from_client; content:"method="; content:"<h3>PATH:"; content:"type=1&file="; content:"type=2&file="; metadata:created_at 2019_03_07; sid:80000014; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_LIST Shell"; flow:established,from_client; content:"method="; content:"<h3>PATH:"; content:"type=1&file="; content:"type=2&file="; content:"type"; content:"file"; metadata:created_at 2019_03_07; sid:80000037; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_LIST Shell"; flow:established,from_client; content:"method="; content:"<h3>PATH:"; content:"type=1&file="; content:"type=2&file="; content:"file"; content:"type"; metadata:created_at 2019_03_07; sid:80000038; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_UP Shell"; flow:established,from_client; content:"ASP_KIT"; content:"up.asp"; content:"modified"; metadata:created_at 2019_03_07; sid:80000015; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type ASP_KIT_UP Shell"; flow:established,from_client; content:"method="; content:"fichero"; content:"Upload"; content:"Target PATH:"; content:"File:"; metadata:created_at 2019_03_07; sid:80000016; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type NTDaddy Shell"; flow:established,from_client; content:"NTDaddy  v1.9"; content:"fux0r  inc"; metadata:created_at 2019_03_07; sid:80000017; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type NTDaddy Shell"; flow:established,from_client; content:"name=lstDrives"; content:"method=post"; content:"name=chkShowDriveInfo"; content:"name=FolderPath"; content:"name=cmdOption"; content:"nwrap=virtual"; metadata:created_at 2019_03_07; sid:80000018; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type NTDaddy Shell"; content:"POST"; http_method; flow:established,from_client; content:"name=lstDrives"; content:"method=post"; content:"name=chkShowDriveInfo"; content:"name=FolderPath"; content:"name=cmdOption"; content:"nwrap=virtual"; content:"FolderPath"; http_client_body; metadata:created_at 2019_03_07; sid:80000039; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type NTDaddy Shell"; content:"POST"; http_method; flow:established,from_client; content:"name=lstDrives"; content:"method=post"; content:"name=chkShowDriveInfo"; content:"name=FolderPath"; content:"name=cmdOption"; content:"nwrap=virtual"; content:"RefreshFolderPath"; content:"CopyFolderTo"; content:"FolderPath"; http_client_body; metadata:created_at 2019_03_07; sid:80000040; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type Remote Explorer Shell"; flow:established,from_client; content:"<title>Remote Explorer</title>"; metadata:created_at 2019_03_07; sid:80000019; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type Remote Explorer Shell"; flow:established,from_client; content:"FolderPath"; content:"Address:"; content:"Name"; content:"Size"; content:"Type"; content:"Modified"; content:"Attributes"; content:"CopyFile="; content:"CopyFolder="; content:"&FolderPath="; metadata:created_at 2019_03_07; sid:80000020; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type Remote Explorer Shell"; flow:established,from_client; content:"FolderPath"; content:"Address:"; content:"Name"; content:"Size"; content:"Type"; content:"Modified"; content:"Attributes"; content:"CopyFile="; content:"CopyFolder="; content:"&FolderPath="; content:"FolderPath"; metadata:created_at 2019_03_07; sid:80000041; rev:1; classtype:web-attack;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Detection Webshell, Type Server Variables Shell"; flow:established,from_client; content:"A list of all server"; content:"Variable Name"; content:"Variable"; content:"ALL_HTTP"; content:"ALL_RAW"; content:"PATH_INFO"; content:"HTTP_HOST"; metadata:created_at 2019_03_07; sid:80000021; rev:1; classtype:web-attack;)
